syms p Kp;
Gsym=Kp*0.4*(p^2-2*p+10)/(p+2)^3;
% ... Bei eingangssignal rampe soll stationäre Regelabweichung
% eInf=1/20 gelten
% ... stationäres verhalten, Systemty i...

expand((p+2)^3);
Kp=4;
G01=tf(Kp*0.4*[1 -2 10],[1 6 12 8]);
%G01=tf(Kp*0.4*[1],[1 6 12 8]);

Kp=1;
G00=tf(Kp*0.4*[1],[1 6 12 8]);

Kp=3;
G02=tf(Kp*0.4*[1 -2 10],[1 6 12 8]);

P=nyquistoptions;
P.showFullContour='off';

MODE=1;

if MODE==0
    f1=figure(1);
    clf;
    hold on;
    nyquist(G01,P)
    %nyquist(G00,P)
    nyquist(G02,P)
    hold off;
    legend('Kp=1','Kp=3')
    syms w

    gsw=subs(Gsym,p,j*w);

    gsw

    f2=figure(2);
    SUB=310;
    clf;
    Cs=tf([0.5 1],[2 1]);
    Cs2=tf([0.5 1],[0.25 1]);

    subplot(SUB+1);
    rlocus(G01)
    legend('G01')

    subplot(SUB+2);
    rlocus(G01*Cs)
    legend('G01*Cs')

    subplot(SUB+3);
    rlocus(G01*Cs2)
    legend('G01*Cs2')



    f3=figure(3);
    SUB=210;
    clf;

    hold all;
    step(zpk([],[-1/5 -1/3 -2],1/7.5))
    step(tf([1],[19 8.5 1]),'--')
    hold off;
    legend('Ps','Ps approx')
end

delete(findall(0,'type','line'))

Kp=1;
G01=tf(Kp*[1],[0.5 1 0]);

Kp1=1.5396;
G02=tf(Kp1*[1],[0.5 1 0]);

P=nyquistoptions;
P.showFullContour='off';

f4=figure(4);
clf;
hold on;
nyquist(G01,P)
nyquist(G02,P)
hold off;
legend(sprintf('Kp=%.4f',Kp1),'Kp=4')

f5=figure(5);

hold all;
step(feedback(G01,1));
step(feedback(G02,1));
hold off;
legend(sprintf('Kp=%.4f',Kp1),'Kp=4')

f6=figure(6);

Kp=0.37;
Kp=1;
G01=tf(Kp*[11 55],[1 14 33 0]);
%G01=tf(Kp*[1],[1 3 0]);
G01zpk=zpk([]);

hold all;
rlocus(G01);
hold off;
%legend(sprintf('Kp=%.4f',Kp1),'Kp=4')

f7=figure(7);

Ps=tf([1 5],[1 3]);
Cs=tf(k*[1],[1 0]);
Ms=tf(11,[1 11])

