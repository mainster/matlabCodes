%% process rx streams from visa scope
% 18-10-2015   visa-commander_v4-0
% MDB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% rx response

rx1 = ['03100002f800034404c800000000000100b2019029f130281b8e20190080191c0000',...
   '00000000000000000001ff00ff00000007fa00000000000000000000000000000000000000'];

nFrms  = hex2dec( rx1(1:2) );
blk(1) = hex2dec( rx1(3:3 + 4) );  

%%
% corrected calib infos
hx=@(x) hex2dec(x); % + 1;

Hcal = [70   12569.00000;
71   6435614.00000;
72   102944696.00000;
74   512.02277;
75   10217102.00000;
76   163433728.00000;
78   812.88104;
79   0.32580;
0   -0.00110;
1    323.29831;
2    0.00101;
3   -0.00084;
4   -320.13049;
73   10185.00000;
5   -0.21095;
6    0.00139;
7   -7.13966;
8    0.02288;
84   0.13400;
10  -9.00700;
11  -0.02249;
85  -0.08390;
80   0.20416;
14   0.00208;
15   2.52546;
16   25.25922;
17   258.02103;
18   2.52546;
19   25.30698;
20   257.91943;
21  -131.00000;
22  -16.00000;
23  -4.00000;
24   72.00004;
25   5.00000;
26  -2.00000;
30  -4.14687;
31   10.88993;
32   0.19785;
33   0.10734;
34   0.27209;
41   1955.54370;
46   1967.67505;
40   87.62467;
45   87.52073;
50   1.06194;
51   1.04043];

Hcal = sort(Hcal);

HI=1;
H=zeros(1, length(Hcal));

for k=1:length(Hcal)
   H(Hcal(k,1)+HI) = Hcal(k,2);
end

H';
%%%%%%%%%%%

h0046 = ['03 10 00 08 B8 00 03 44 04 C8 00 00 00 00 00 00 00 B0 01 8F 29 F6 30',...
       '2A 1B AB 19 27 00 7D 19 23 00 00 00 00 00 00 00 00 00 00 00 01 FF 00',...
       'FF 00 00 00 07 FA 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00'];

h0046d = hex2dec(strsplit(h0046, ' '))';

clear h 
for cnt=hx('10'):2:hx('1f')
   h.(sprintf('h%2x%2x', cnt, cnt+1)) = h0046d(cnt) * 2^8 + h0046d(cnt);
   hxx.(sprintf('h%2x%2x', cnt, cnt+1)) = dec2hex(h.(sprintf('h%2x%2x', cnt, cnt+1)));
end

h
hxx






